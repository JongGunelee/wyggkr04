<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link type="text/css" rel="stylesheet" href="resources/sheet.css">
<style type="text/css">
    /* --- 기존 스타일 --- */
    .ritz .waffle a { color: inherit; }
    .ritz .waffle .s4{border-bottom:2px SOLID #000000;border-right:1px SOLID transparent;background-color:#d8d8d8;text-align:left;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:14pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s13{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:center;color:#000000;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s23{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:left;text-decoration:underline;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s18{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s9{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #999999;background-color:#deeaf6;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s8{border-bottom:2px SOLID #000000;border-right:1px SOLID #999999;background-color:#deeaf6;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s11{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s0{border-bottom:1px SOLID transparent;background-color:#ffffff;text-align:left;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:18pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s29{border-bottom:2px SOLID #000000;border-right:2px SOLID #000000;background-color:#ffffff;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s12{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s14{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:right;color:#000000;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s16{border-bottom:1px SOLID #cccccc;border-right:2px SOLID #000000;background-color:#ffffff;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s15{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:left;text-decoration:underline;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s6{border-bottom:1px SOLID transparent;border-right:2px SOLID #000000;background-color:#d8d8d8;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s22{border-bottom:1px SOLID #cccccc;border-right:2px SOLID #000000;background-color:#e8f0fe;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s20{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:right;color:#000000;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s24{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:left;text-decoration:underline;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s1{border-bottom:1px SOLID transparent;background-color:#ffffff;text-align:center;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s10{border-bottom:2px SOLID #000000;border-right:2px SOLID #000000;background-color:#deeaf6;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s3{border-bottom:1px SOLID transparent;border-right:1px SOLID transparent;background-color:#d8d8d8;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s26{border-bottom:2px SOLID #000000;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:left;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s5{border-bottom:2px SOLID #000000;border-right:1px SOLID transparent;background-color:#d8d8d8;text-align:center;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s2{border-bottom:1px SOLID transparent;background-color:#ffffff;}
    .ritz .waffle .s17{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s21{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:left;text-decoration:underline;text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0563c1;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s7{border-bottom:2px SOLID #000000;border-right:1px SOLID #999999;background-color:#deeaf6;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:13pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s25{border-bottom:2px SOLID #000000;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:center;font-weight:bold;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s27{border-bottom:2px SOLID #000000;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:center;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:nowrap;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s19{border-bottom:1px SOLID #cccccc;border-right:1px SOLID #cccccc;background-color:#e8f0fe;text-align:center;color:#000000;font-family:"Malgun Gothic";font-size:12pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}
    .ritz .waffle .s28{border-bottom:2px SOLID #000000;border-right:1px SOLID #cccccc;background-color:#ffffff;text-align:left;color:#000000;font-family:"Malgun Gothic";font-size:11pt;vertical-align:middle;white-space:normal;overflow:hidden;word-wrap:break-word;direction:ltr;padding:0px 3px 0px 3px;}

    /* --- 새로 추가된 스타일 --- */
    /* 행/열 헤더(숫자, 알파벳) 숨기기 */
    .row-headers-background, .column-headers-background {
        display: none;
    }
    .title-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-right: 13px; /* 비고 컬럼의 오른쪽 패딩에 맞춤 */
    }
    #control-panel {
        text-align: right;
    }
    #control-panel button {
        background-color: #f0f0f0;
        border: 1px solid #cccccc;
        padding: 5px 12px;
        font-family: "Malgun Gothic", sans-serif;
        font-size: 10pt;
        cursor: pointer;
        border-radius: 4px;
        margin-left: 8px;
        font-weight: bold;
        color: #333;
    }
    #control-panel button:hover {
        background-color: #e0e0e0;
        border-color: #999999;
    }
    .checkbox-cell {
        cursor: pointer;
    }
    /* contenteditable 상태에서 포커스될 때의 기본 아웃라인 제거 */
    [contenteditable]:focus {
        outline: 2px solid #4d90fe; /* 편집 중인 셀을 명확하게 표시 */
        outline-offset: -2px;
    }
</style>
</head>
<body>

<svg style="display:none;" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <defs>
        <path id="checked-checkbox-id" d="M17,3 L4.75,3 C3.77875,3 3,3.7875 3,4.75 L3,17 C3,17.9625 3.77875,18.75 4.75,18.75 L17,18.75 C17.97125,18.75 18.75,17.9625 18.75,17 L18.75,4.75 C18.75,3.7875 17.97125,3 17,3 L17,3 Z M9.125,15.25 L4.75,10.875 L5.98375,9.64125 L9.125,12.77375 L15.76625,6.1325 L17,7.375 L9.125,15.25 L9.125,15.25 Z" transform="translate(-3.000000, -3.000000)"></path>
        <path id="unchecked-checkbox-id" d="M17,3.75 L17,16 L4.75,16 L4.75,3.75 L17,3.75 L17,3.75 Z M17,2 L4.75,2 C3.7875,2 3,2.7875 3,3.75 L3,16 C3,16.9625 3.7875,17.75 4.75,17.75 L17,17.75 C17.9625,17.75 18.75,16.9625 18.75,16 L18.75,3.75 C18.75,2.7875 17.9625,2 17,2 L17,2 Z" transform="translate(-3.000000, -2.000000)"></path>
    </defs>
</svg>

<div class="ritz grid-container" dir="ltr">
    <table class="waffle" cellspacing="0" cellpadding="0">
        <thead>
            <tr>
                <th class="row-header freezebar-origin-ltr"></th>
                <th id="1296256726C0" style="width:10px;" class="column-headers-background">A</th>
                <th id="1296256726C1" style="width:43px;" class="column-headers-background">B</th>
                <th id="1296256726C2" style="width:461px;" class="column-headers-background">C</th>
                <th id="1296256726C3" style="width:108px;" class="column-headers-background">D</th>
                <th id="1296256726C4" style="width:131px;" class="column-headers-background">E</th>
                <th id="1296256726C5" style="width:88px;" class="column-headers-background">F</th>
                <th id="1296256726C6" style="width:59px;" class="column-headers-background">G</th>
                <th id="1296256726C7" style="width:59px;" class="column-headers-background">H</th>
                <th id="1296256726C8" style="width:475px;" class="column-headers-background">I</th>
                <th id="1296256726C9" style="width:113px;" class="column-headers-background">J</th>
                <th id="1296256726C10" style="width:10px;" class="column-headers-background">K</th>
            </tr>
        </thead>
        <tbody>
            <tr style="height: 2px">
                <th id="1296256726R0" style="height: 2px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 2px">1</div></th>
                <td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td>
            </tr>
            <tr style="height: 33px">
                <th id="1296256726R1" style="height: 33px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 33px">2</div></th>
                <td class="s0" colspan="9" contenteditable="false">
                    <div class="title-container">
                        <span contenteditable="true">■ 25년 하반기 연간 계획 목록</span>
                        <div id="control-panel">
                            <button id="saveHtmlBtn">HTML로 저장</button>
                            <button id="exportExcelBtn">엑셀 파일로 추출</button>
                        </div>
                    </div>
                </td>
                <td class="s1"></td>
                <td class="s2"></td>
            </tr>
            <tr style="height: 12px">
                <th id="1296256726R2" style="height: 12px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 12px">3</div></th>
                <td class="s3"></td><td class="s4"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s5"></td><td class="s3"></td>
            </tr>
            <tr style="height: 25px">
                <th id="1296256726R3" style="height: 25px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 25px">4</div></th>
                <td class="s6"></td><td class="s7" rowspan="2">NO.</td><td class="s7" rowspan="2">작업 목록</td><td class="s8" rowspan="2">예 산</td><td class="s8" dir="ltr" rowspan="2">1차 <br>견적 접수</td><td class="s8" rowspan="2">현황</td><td class="s9" colspan="2">이월</td><td class="s7" rowspan="2">작업 계획</td><td class="s10" rowspan="2">비고</td><td class="s3"></td>
            </tr>
            <tr style="height: 26px">
                <th id="1296256726R4" style="height: 26px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 26px">5</div></th>
                <td class="s6"></td><td class="s7">전체</td><td class="s7">부분</td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R5" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">6</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">1</td><td class="s12" contenteditable="true">기계실 안전변 교체 및 급탕 시스템 플러싱</td><td class="s13" contenteditable="true">  5,000,000 </td><td class="s14" contenteditable="true">4,000,000</td><td class="s13" dir="ltr" contenteditable="true"> 안전밸브만</td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#checked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s15" contenteditable="true">안전밸브→ AB동: 5개 / 3동: 4개 / 102동: 1개</td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R6" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">7</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">2</td><td class="s18" contenteditable="true">기숙사동 노후 급탕 및 난방 순환 펌프 교체</td><td class="s19" contenteditable="true">  50,000,000 </td><td class="s20" contenteditable="true"></td><td class="s19" contenteditable="true"></td>
                <td class="s19 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s21" contenteditable="true"></td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R7" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">8</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">3</td><td class="s12" contenteditable="true">사택 세대내 노후 전원 차단기 및 분전반 교체</td><td class="s13" contenteditable="true">  25,000,000 </td><td class="s14" contenteditable="true"></td><td class="s13" contenteditable="true"></td>
                <td class="s13 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s15" contenteditable="true"></td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R8" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">9</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">4</td><td class="s18" contenteditable="true">무정전 전원공급 장치 (UPS) 배터리 교체</td><td class="s19" contenteditable="true">  20,000,000 </td><td class="s20" contenteditable="true">8,000,000</td><td class="s19" contenteditable="true"></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s21" contenteditable="true"></td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R9" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">10</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">5</td><td class="s12" contenteditable="true">3동 및 사택 102동  전기실 비상발전기 소모품 교체</td><td class="s13" contenteditable="true">  6,000,000 </td><td class="s14" contenteditable="true"></td><td class="s13" contenteditable="true"></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s15" contenteditable="true"></td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R10" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">11</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">6</td><td class="s18" contenteditable="true">사택 단지내 아스팔트 노면 보수 ( 도로 )</td><td class="s19" contenteditable="true">  50,000,000 </td><td class="s20" contenteditable="true">13,000,000</td><td class="s19" contenteditable="true"></td>
                <td class="s19 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s21" contenteditable="true">2동 2개소 및 8동 2개소 침하 우수 맨홀 보수</td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R11" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">12</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">7</td><td class="s12" contenteditable="true">기숙사 AB동 노후 시스템 창호용 방충망 교체 (공용)</td><td class="s13" contenteditable="true">  18,000,000 </td><td class="s14" contenteditable="true">1,600,000</td><td class="s13" dir="ltr" contenteditable="true"> 1층<br>24세대</td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s15" dir="ltr" contenteditable="true">대상 세대▷ A동: 207세대(VIP포함) / B동: 102세대</td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R12" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">13</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">8</td><td class="s18" contenteditable="true">기숙사 AB동 노후 시스템 창호용 방충망 교체 (세대내)</td><td class="s19" contenteditable="true">  8,000,000 </td><td class="s20" contenteditable="true">4,800,000</td><td class="s19" dir="ltr" contenteditable="true"> 1층만<br>1층 8개소</td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s21" dir="ltr" contenteditable="true">대상 층▷ A동: 2층-11층(10층) / B: 2층-10층(9층)</td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R13" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">14</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">9</td><td class="s12" contenteditable="true">기숙사 AB동 지하 주차장 급,배기휀 윤활유 교체</td><td class="s13" contenteditable="true">  4,000,000 </td><td class="s14" contenteditable="true"></td><td class="s13" contenteditable="true"></td>
                <td class="s13 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s15" contenteditable="true"></td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R14" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">15</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">10</td><td class="s18" contenteditable="true">기숙사 AB동 지하 주차장 유인휀 교체</td><td class="s19" contenteditable="true">  30,000,000 </td><td class="s20" contenteditable="true">14,000,000</td><td class="s19" contenteditable="true"></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s21" contenteditable="true">2700CMH*140W : 20set</td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R15" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">16</div></th>
                <td class="s6"></td><td class="s11" contenteditable="true">11</td><td class="s12" contenteditable="true">사택 102동 어린이집 놀이터 입구 보도블럭 교체('24년分)</td><td class="s13" contenteditable="true">  14,000,000 </td><td class="s14" contenteditable="true">13,000,000</td><td class="s13" contenteditable="true"></td>
                <td class="s13 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#checked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s13 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s23" contenteditable="true"></td><td class="s16" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R16" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">17</div></th>
                <td class="s6"></td><td class="s17" contenteditable="true">12</td><td class="s18" contenteditable="true">기숙사 AB동 CO2 측정센서 교체('24년分)</td><td class="s19" contenteditable="true">  3,000,000 </td><td class="s19" contenteditable="true"></td><td class="s19" contenteditable="true"></td>
                <td class="s19 checkbox-cell" dir="ltr"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#checked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s19 checkbox-cell"><svg width="16px" height="16px" viewBox="0 0 16 16" style="display:inline;"><use href="#unchecked-checkbox-id" fill="#000000"></use></svg></td>
                <td class="s24" contenteditable="true"></td><td class="s22" contenteditable="true"></td><td class="s3"></td>
            </tr>
            <tr style="height: 49px">
                <th id="1296256726R17" style="height: 49px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 49px">18</div></th>
                <td class="s6"></td><td class="s25"></td><td class="s26"></td><td class="s27"></td><td class="s27"></td><td class="s27"></td><td class="s27"></td><td class="s27"></td><td class="s28"></td><td class="s29"></td><td class="s3"></td>
            </tr>
            <tr style="height: 12px">
                <th id="1296256726R18" style="height: 12px;" class="row-headers-background"><div class="row-header-wrapper" style="line-height: 12px">19</div></th>
                <td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td><td class="s3"></td>
            </tr>
        </tbody>
    </table>
</div>

<!-- 엑셀 추출 라이브러리 (SheetJS) -->
<script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>

<!-- 기능 구현을 위한 JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {

    // --- 체크박스 토글 기능 ---
    const table = document.querySelector('.waffle');
    table.addEventListener('mousedown', function(e) {
        const targetCell = e.target.closest('td.checkbox-cell');
        if (!targetCell) return;
        
        // 편집 모드의 기본 동작(텍스트 커서 생성)을 막습니다.
        e.preventDefault();

        const svg = targetCell.querySelector('svg');
        if (!svg) return;

        const use = svg.querySelector('use');
        if (!use) return;
        
        const currentHref = use.getAttribute('href');
        if (currentHref === '#unchecked-checkbox-id') {
            use.setAttribute('href', '#checked-checkbox-id');
        } else if (currentHref === '#checked-checkbox-id') {
            use.setAttribute('href', '#unchecked-checkbox-id');
        }
    });

    // --- HTML로 저장 기능 ---
    document.getElementById('saveHtmlBtn').addEventListener('click', function() {
        const pageHTML = document.documentElement.outerHTML;
        const blob = new Blob([pageHTML], { type: 'text/html;charset=utf-8' });

        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = '25년_하반기_연간_계획_목록_저장됨.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(a.href);
    });

    // --- 엑셀 파일로 추출 기능 ---
    document.getElementById('exportExcelBtn').addEventListener('click', function() {
        const table = document.querySelector('table.waffle');
        const dataForExcel = [];

        // 1. 헤더 생성
        const headers = ["NO.", "작업 목록", "예 산", "1차 견적 접수", "현황", "이월(전체)", "이월(부분)", "작업 계획", "비고"];
        dataForExcel.push(headers);

        // 2. 데이터 행 처리
        for (let i = 5; i < table.rows.length; i++) {
            const row = table.rows[i];
            if (row.cells.length < 9 || row.id === '1296256726R17') continue;

            const rowData = [];
            // B부터 J까지의 컬럼 데이터 (셀 인덱스 1부터 9)
            for (let j = 1; j <= 9; j++) {
                const cell = row.cells[j];
                if (!cell) {
                    rowData.push('');
                    continue;
                }
                const checkbox = cell.querySelector('svg > use');
                if (checkbox) {
                    const isChecked = checkbox.getAttribute('href') === '#checked-checkbox-id';
                    rowData.push(isChecked ? 'V' : '');
                } else {
                    let text = cell.innerText.replace(/(\r\n|\n|\r)/gm, " ").trim();
                    text = text.replace(/\s\s+/g, ' ');
                    rowData.push(text);
                }
            }
            dataForExcel.push(rowData);
        }
        
        // 3. 워크시트 및 워크북 생성
        const ws = XLSX.utils.aoa_to_sheet(dataForExcel);

        const colWidths = [];
        dataForExcel.forEach(row => {
            row.forEach((cell, i) => {
                const len = cell ? String(cell).length * 1.2 : 10;
                if (!colWidths[i] || colWidths[i].wch < len) {
                    colWidths[i] = { wch: len };
                }
            });
        });
        colWidths[1] = { wch: 50 };
        colWidths[7] = { wch: 50 };
        ws['!cols'] = colWidths;

        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "25년 하반기 연간 계획");

        // 4. 파일 다운로드
        XLSX.writeFile(wb, "25년_하반기_연간_계획_목록.xlsx");
    });

});
</script>


</body></html>