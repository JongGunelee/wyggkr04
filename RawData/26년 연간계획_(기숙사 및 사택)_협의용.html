<!DOCTYPE html>
<html lang="ko"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>26ë…„ ì—°ê°„ê³„íš (ì–‘ì‹)</title>
    <style type="text/css">
        /* --- ê¸°ë³¸ ë° ê¸°ëŠ¥ êµ¬í˜„ ìŠ¤íƒ€ì¼ --- */
        body { font-family: "Malgun Gothic", sans-serif; user-select: none; }
        .grid-container { padding: 10px; }
        .title-container { display: flex; justify-content: space-between; align-items: center; padding: 5px; margin-bottom: 10px; }
        .s0 { font-weight: bold; font-size: 18pt; }
        
        #main-table {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #999;
        }

        #main-table th, #main-table td {
            border: 1px solid #cccccc;
            padding: 8px 5px;
            font-size: 10pt;
            white-space: normal;
            word-wrap: break-word;
            position: relative;
        }
        
        #main-table td {
            vertical-align: middle;
            text-align: left;
        }

        /* í–‰ êµì°¨ ìƒ‰ìƒ (Zebra Striping) */
        #main-table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        #main-table .no-cell, #main-table thead th {
            cursor: pointer;
        }

        #main-table .no-cell {
            text-align: center;
            vertical-align: middle;
            user-select: none;
        }
        
        /* 'ì ìš©' ì—´ ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        #main-table .checkbox-cell {
            text-align: center;
            font-weight: bold;
            font-size: 14pt;
            cursor: pointer;
            user-select: none;
        }

        /* 'íˆ¬ìê¸ˆì•¡' ì—´ ìˆ«ì ìŠ¤íƒ€ì¼ */
        #main-table .currency-cell {
            text-align: right;
        }

        #main-table tbody tr {
            position: relative; 
        }

        #main-table thead th {
            background-color: #deeaf6;
            text-align: center;
            vertical-align: middle;
            font-weight: bold;
            font-size: 11pt;
            border: 1px solid #999999;
            user-select: none;
        }
        
        #control-panel { display: flex; align-items: center; gap: 8px; flex-wrap: wrap;}
        #control-panel .button-group { display: flex; align-items: center; gap: 8px;}
        #control-panel button { background-color: #f0f0f0; border: 1px solid #cccccc; padding: 5px 12px; font-family: "Malgun Gothic", sans-serif; font-size: 10pt; cursor: pointer; border-radius: 4px; font-weight: bold; color: #333; }
        #control-panel button:hover { background-color: #e0e0e0; border-color: #999999; }
        [contenteditable] { -webkit-user-select: text; user-select: text; }
        [contenteditable]:focus { outline: 2px solid #4d90fe; outline-offset: -2px; }
        #text-editor-menu { display: flex; flex-wrap: wrap; align-items: center; gap: 5px; background-color: #fff; border: 1px solid #ccc; border-radius: 6px; padding: 4px 6px; }
        #text-editor-menu .editor-group { display: inline-flex; align-items: center; gap: 5px; }
        #text-editor-menu button { background-color: transparent; border: none; color: #333; cursor: pointer; padding: 4px; border-radius: 4px; display: flex; align-items: center; justify-content: center; }
        #text-editor-menu button svg { width: 18px; height: 18px; fill: #333; }
        #text-editor-menu button:hover, #text-editor-menu button.active { background-color: #e9e9e9; }
        #text-editor-menu select, #text-editor-menu input[type="color"] { background-color: #fff; color: #333; border: 1px solid #ccc; border-radius: 4px; padding: 2px; font-family: "Malgun Gothic", sans-serif; font-size: 10pt; height: 28px; }
        #text-editor-menu input[type="color"] { padding: 1px; width: 28px; border: 1px solid #ccc; cursor: pointer; }
        .editor-separator { width: 1px; height: 20px; background-color: #ccc; margin: 0 4px; }
        .cell-selected { background-color: #d9eaff !important; outline: 2px solid #1a73e8 !important; outline-offset: -2px; }

        .resizer-col { position: absolute; top: 0; right: -4px; width: 8px; height: 100%; cursor: col-resize; z-index: 10; }
        .resizer-row { position: absolute; left: 0; bottom: -4px; width: 100%; height: 8px; cursor: row-resize; z-index: 10; }

        #context-menu {
            display: none; position: absolute; z-index: 1000; background-color: #f9f9f9;
            border: 1px solid #ccc; border-radius: 5px; box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
            padding: 5px 0; font-family: "Malgun Gothic", sans-serif; font-size: 10pt;
        }
        #context-menu ul { list-style: none; margin: 0; padding: 0; }
        #context-menu li { padding: 8px 15px; cursor: pointer; }
        #context-menu li:hover { background-color: #e0e0e0; }
        #context-menu .separator { height: 1px; background-color: #ccc; margin: 4px 0; }
    </style>
</head>
<body>

<div class="grid-container">
    <div class="title-container">
        <span class="s0" contenteditable="true">'26ë…„ ì—°ê°„ ê³„íš ( í˜‘ì˜ìš© )&nbsp;</span>
        <div id="control-panel">
             <div id="text-editor-menu">
                <div class="editor-group">
                    <button id="editor-bold" title="êµµê²Œ" class=""><svg viewBox="0 0 24 24"><path d="M15.6,10.79c.97-.67,1.65-1.77,1.65-2.79,0-2.26-1.75-4-4.25-4H7v14h7.04c2.1,0,3.71-1.7,3.71-3.78,0-1.52-.86-2.82-2.15-3.43Zm-5.6-4.79h3.4c1.14,0,2.1.92,2.1,2.05,0,1.13-.96,2.05-2.1,2.05h-3.4V6Zm3.54,9H9.5V13h3.04c1.14,0,2.06.92,2.06,2.05,0,1.13-.92,2.04-2.06,2.04Z"></path></svg></button>
                    <button id="editor-italic" title="ê¸°ìš¸ì„"><svg viewBox="0 0 24 24"><path d="M10,4v3h2.21l-3.42,8H6v3h8v-3h-2.21l3.42-8H18V4Z"></path></svg></button>
                    <button id="editor-underline" title="ë°‘ì¤„"><svg viewBox="0 0 24 24"><path d="M12,17c3.31,0,6-2.69,6-6V3h-2.5v8c0,1.93-1.57,3.5-3.5,3.5S8.5,12.93,8.5,11V3H6v8c0,3.31,2.69,6,6,6Zm-7,2v2h14v-2Z"></path></svg></button>
                    <button id="editor-link" title="ë§í¬ ì‚½ì…"><svg viewBox="0 0 24 24"><path d="M3.9,12c0-1.71,1.39-3.1,3.1-3.1h4V7H7c-2.76,0-5,2.24-5,5s2.24,5,5,5h4v-1.9H7C5.29,15.1,3.9,13.71,3.9,12z M8,13h8v-2H8V13z M17,7h-4v1.9h4c1.71,0,3.1,1.39,3.1,3.1s-1.39,3.1-3.1,3.1h-4V17h4c2.76,0,5-2.24,5-5S19.76,7,17,7z"></path></svg></button>
                    <button id="editor-unlink" title="ë§í¬ ì œê±°"><svg viewBox="0 0 24 24"><path d="M17,7h-4v1.9h4c1.71,0,3.1,1.39,3.1,3.1s-1.39,3.1-3.1,3.1h-4V17h4c2.76,0,5-2.24,5-5S19.76,7,17,7z M10.1,14.5l-1.5-1.5L14.5,7H17v2.5l-4.4,4.4V17h-2.5L10.1,14.5z M7,15.1c-1.71,0-3.1-1.39-3.1-3.1s1.39-3.1,3.1-3.1h4V7H7c-2.76,0-5,2.24-5,5s2.24,5,5,5h4v-1.9H7z"></path></svg></button>
                </div>
                <div class="editor-separator"></div>
                <div class="editor-group">
                    <select id="editor-fontsize" title="ê¸€ì í¬ê¸°"><option value="">ê¸°ë³¸</option><option value="10pt">10pt</option><option value="11pt">11pt</option><option value="12pt">12pt</option><option value="14pt">14pt</option><option value="16pt">16pt</option><option value="18pt">18pt</option></select>
                    <input type="color" id="editor-color" title="ê¸€ì ìƒ‰" value="#000000">
                </div>
                <div class="editor-separator"></div>
                <div class="editor-group" id="align-h-group">
                    <button id="align-left" title="ì™¼ìª½ ì •ë ¬" class=""><svg viewBox="0 0 24 24"><path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"></path></svg></button>
                    <button id="align-center" title="ê°€ìš´ë° ì •ë ¬" class=""><svg viewBox="0 0 24 24"><path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"></path></svg></button>
                    <button id="align-right" title="ì˜¤ë¥¸ìª½ ì •ë ¬" class=""><svg viewBox="0 0 24 24"><path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"></path></svg></button>
                </div>
                 <div class="editor-separator"></div>
                <div class="editor-group" id="align-v-group">
                    <button id="align-top" title="ìœ„ìª½ ì •ë ¬"><svg viewBox="0 0 24 24"><path d="M8 11h3v10h2V11h3l-4-4-4 4zM4 3v2h16V3H4z"></path></svg></button>
                    <button id="align-middle" title="ì¤‘ê°„ ì •ë ¬" class=""><svg viewBox="0 0 24 24"><path d="M8 15h3v4h2v-4h3l-4-4-4 4zM4 11v2h16v-2H4zM8 9h3V5h2v4h3l-4 4-4-4z"></path></svg></button>
                    <button id="align-bottom" title="ì•„ë˜ìª½ ì •ë ¬"><svg viewBox="0 0 24 24"><path d="M8 13h3V3h2v10h3l-4 4-4-4zM4 21v-2h16v2H4z"></path></svg></button>
                </div>
            </div>
             <div class="button-group">
                <input type="file" id="excel-file-input" accept=".xls, .xlsx" style="display: none;">
                <button id="importExcelBtn">ì—‘ì…€ ë§¤í•‘</button>
                <button id="exportExcelBtn">ì—‘ì…€ ì¶”ì¶œ</button>
                <button id="saveHtmlBtn">HTML ì €ì¥</button>
            </div>
        </div>
    </div>
    
    <div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><div class="resizer-row"></div><table id="main-table">
        <colgroup>
            <col style="width: 43px;">
            <col style="width: 79px;">
            <col style="width: 361px;">
            <col style="width: 79px;">
            <col style="width: 58px;">
            <col style="width: 55px;">
            <col style="width: 47px;">
            <col style="width: 488px;">
            <col style="width: 144px;">
        </colgroup>
        <thead>
            <tr>
                <th>NO.<div class="resizer-col"></div></th><th>êµ¬ë¶„<div class="resizer-col"></div></th><th>ê³µì‚¬ëª…<div class="resizer-col"></div></th><th>íˆ¬ìê¸ˆì•¡<br>(ì²œì›)<div class="resizer-col"></div></th><th>ì…ê³ ì›”<br>(ì˜ˆì •)<div class="resizer-col"></div></th><th>ê³µì¢…<div class="resizer-col"></div></th><th>ì ìš©<div class="resizer-col"></div></th><th>íˆ¬ìëª©ì  ë° ê¸°ëŒ€íš¨ê³¼<div class="resizer-col"></div></th><th>ë¹„ê³ <div class="resizer-col"></div></th>
            </tr>
        </thead>
        <tbody><tr><td class="no-cell">1</td><td contenteditable="true" class="" style="text-align: center;">íˆ¬ì
(ìì‚°)</td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ABë™ ì§€í•˜ê¸°ê³„ì‹¤ ë…¸í›„ ì§„ê³µì˜¨ìˆ˜ ë³´ì¼ëŸ¬ êµì²´</td><td contenteditable="true" class="currency-cell">75,000</td><td contenteditable="true" class="" style="text-align: center;">8ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì´ 3ëŒ€ì¤‘ ('23ë…„,'24ë…„ ê° 1ëŒ€ì”© êµì²´ ì™„ë£Œ)
24ë…„ ì‹¤ì ê°€ì˜ ë‹¨ê°€ìƒìŠ¹ìœ¨ 20% ì˜ˆìƒ
ê¸°ì¡´ 1ëŒ€ í•œì‹ ë³´ì¼ëŸ¬  ì œì¡°ì‚¬ (ë‹¨ì¢…)-&gt;ë¶€ìŠ¤íƒ€ë³´ì¼ëŸ¬
ë³´ì¼ëŸ¬ ì œì‘ë¬¼/ë‚©í’ˆì„±(ì›ê°€ì ˆê°), 3ê°œì›”ì „ ë°œì£¼
ë°°ê´€,ì—°ë„ê°œì¡° / ê¸°ì¡´ ë³´ì¼ëŸ¬ ë°˜ì¶œí›„ íê¸°ë¬¼ì²˜ë¦¬</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">2</td><td contenteditable="true" class="" style="text-align: center;">íˆ¬ì
(ìì‚°)</td><td contenteditable="true" class="">ì‚¬íƒ 101-103ë™ ì„¸ëŒ€ë‚´ ê°œë³„ë‚œë°© ë³´ì¼ëŸ¬ êµì²´</td><td contenteditable="true" class="currency-cell">14,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ë…¸í›„ë¡œ ì¸í•œ êµì²´(10ë…„)â†’ 63ì„¸ëŒ€(êµì²´ëŒ€ìƒ)
â†’ 12ì„¸ëŒ€(25ë…„ í•˜ë°˜ê¸° ì‹¤ì )*110ë§Œì›(ë‚©í’ˆì„±)</td><td contenteditable="true" class="">ê³ ì¥ì‹œ êµì²´ì¤‘
(ìì‚°)</td><div class="resizer-row"></div></tr><tr><td class="no-cell">3</td><td contenteditable="true" class="" style="text-align: center;">íˆ¬ì
(ìì‚°)</td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬/ì‚¬íƒ ê¸°ê³„ì‹¤ ë…¸í›„ íŒí”„ ë° ë°°ê´€ ì•¡ì„œë¦¬ êµì²´</td><td contenteditable="true" class="currency-cell">50,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ë…¸í›„ íŒí”„ ë° ë°°ê´€ ì•¡ì„¸ì„œë¦¬ í¬í•¨(ì—°ê°„ ë¶€ë¶„ êµì²´ ë° ë³´ìˆ˜)
ì˜ˆìƒ ì´ë¹„ìš©: 1.01ì–µì›
3ë™: 2,700ë°±ë§Œì› / ABë™ 6,600ë°±ë§Œì›
102ë™: 470ë§Œì› / ê³µë™êµ¬ 270ë§Œì›</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">4</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ 
(ìì‚°)</td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ABë™ ì§€í•˜ ì£¼ì°¨ì¥ ìœ ì¸íœ€ êµì²´</td><td contenteditable="true" class="currency-cell">30,000</td><td contenteditable="true" class="" style="text-align: center;">5ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ì§€í•˜ ì£¼ì°¨ì¥ ì²œì¥í˜• í™˜ê¸°íœ€ : 20ëŒ€
ê¸°ì¡´ 20ëŒ€ ì² ê±° ë° ì‹ ê·œ ì„¤ì¹˜</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">5</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì™¸ë¶€ì„ì°¨ ì‚¬íƒ ìˆ˜ì¥ê³µì‚¬</td><td contenteditable="true" class="currency-cell">26,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì—°í‰ê·  ê¸°ì¤€ ('3ë…„)</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">6</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬/ì‚¬íƒ ê¸´ê¸‰ê³µì‚¬ ë¹„ìƒë³µêµ¬ ìˆ˜ì„ ë¹„ìš©</td><td contenteditable="true" class="currency-cell">20,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ê³„íš ê¸°ì¤€</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">7</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ë™ ë° ì–´ë¦°ì´ì§‘ EHP ì¼€ì–´</td><td contenteditable="true" class="currency-cell">10,000</td><td contenteditable="true" class="" style="text-align: center;">4ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ê¸°ìˆ™ì‚¬ë™ ë° ê³µìš©ë¶€ : í•„í„° ì²­ì†Œ
ì–´ë¦°ì´ì§‘ : ì˜¤ë²„í™€ ì„¸ì²™</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">8</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ì–´ë¦°ì´ì§‘ ì „ì—´êµí™˜ê¸° í•„í„° ë° ì „ì—´ì†Œì êµì²´</td><td contenteditable="true" class="currency-cell">7,000</td><td contenteditable="true" class="" style="text-align: center;">4ì›”/9ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ìƒ,í•˜ë°˜ê¸° ê³ íš¨ìœ¨ í•„í„° êµì²´ ë° ì·¨ì¶œêµ¬ ì„¸ì²™</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">9</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ê³µê°€ì„¸ëŒ€ ìˆ˜ì¥ê³µì‚¬</td><td contenteditable="true" class="currency-cell">200,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì—°í‰ê·  50ì„¸ëŒ€(3ê°œë…„ í‰ê· )*400ë§Œì›(3ê°œë…„ í‰ê· )</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">10</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ì„¸ëŒ€ë‚´ í™˜ê²½ê°œì„  (5ë™,8ë™,9ë™)</td><td contenteditable="true" class="currency-cell">150,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê³µí†µ</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì„¸ëŒ€ë‚´ ë°”ë‹¥ë‚œë°© í™ˆíŒŒê¸° ë° ë…¸í›„ ë§¤ë¦½ë°°ê´€ êµì²´(ê¸°ê³„,ê±´ì¶•)
ì„¸ëŒ€ë‹¹ 3,000ë§Œì›*5ì„¸ëŒ€/ì—°ê°„ì˜ˆì •ì„¸ëŒ€</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">11</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ì§€ë¶• ê¸°ì™€ ë³´ìˆ˜</td><td contenteditable="true" class="currency-cell">20,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">25ë…„ 8ë™ ì •ë©´ ê¸°ì™€ ë°°ìˆ˜ë¡œ êµì²´(íƒ€ê³µ-&gt;ë§‰í˜) , '25ë…„ ì‹¤ì ê°€
23ë…„ 7ë™ ê¸°ì™€ ë„ì¥ ì™„ë£Œ/ ì”ì—¬ ë°°ìˆ˜ë¡œ  : 5ë™ , 7ë™ , 8ë™ , 9ë™</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">12</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ì”½í¬ëŒ€ ìˆ˜ë¦¬ ë° ë¶™ë°•ì´ì¥ ë³´ìˆ˜</td><td contenteditable="true" class="currency-cell">15,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ë…¸í›„ ì”½í¬ëŒ€ ìˆ˜ë¦¬ë¡œ ì „í™˜
25ë…„ í•˜ë°˜ê¸° ì§‘í–‰ë¹„ ê¸°ì¤€(13ê±´): 14,000ì²œì›</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">13</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ëˆ„ìˆ˜ ë³´ìˆ˜ ê³µì‚¬</td><td contenteditable="true" class="currency-cell">17,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ê³„íš ê¸°ì¤€</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">14</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ë‹¨ì§€ë‚´ ì•„ìŠ¤íŒ”íŠ¸ ë…¸ë©´ ë³´ìˆ˜ ( ë„ë¡œ )</td><td contenteditable="true" class="currency-cell">40,000</td><td contenteditable="true" class="" style="text-align: center;">11ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ABë™,8ë™ : ì¬í™œìš©ì¥ ì• / 1,2ë™ ì§„ì…ë¡œ / 5ë™ ì£¼ì¶œì…ë¡œ  </td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">15</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ 5ë™ ê²½ë¹„ì‹¤ ë‚´ë¶€ í™˜ê²½ê°œì„  ê³µì‚¬(ê±´ì¶•,ì „ê¸°,ì†Œë°©)</td><td contenteditable="true" class="currency-cell">60,000</td><td contenteditable="true" class="" style="text-align: center;">11ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê³µí†µ</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ì²œì¥,ì±…ìƒ,íŒŒí‹°ì…˜ë“±(í™˜ê²½ê°œì„  ì´ë¯¸ì§€ ì‘ì„±ë¹„ í¬í•¨)</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">16</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ 101-104ë™ ì˜¥ìƒ ë°©ìˆ˜ ë³´ìˆ˜</td><td contenteditable="true" class="currency-cell">30,000</td><td contenteditable="true" class="" style="text-align: center;">9ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ë°”ë‹¥ë©´ì  : 2,675m2 =&gt; ë¶€ë¶„ë³´ìˆ˜ ì‘ì—…
ìš°ë ˆíƒ„(ë°”ë‹¥ 3t , ë²½ 0.5t)=&gt;ê¸°ì¡´ ë²½ë§ˆê° ì² ê±°í›„ ë°©ìˆ˜
ë°”ë‹¥ ì¤„ëˆˆ ì½”í‚¹ ì‘ì—… , ì˜¥ìƒì¸µ E/V PIT ë²½ ë° ë°”ë‹¥ í¬í•¨</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">17</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ 7ë™ ì„¸ëŒ€ë‚´ LEDë“± êµì²´ </td><td contenteditable="true" class="currency-cell">10,000</td><td contenteditable="true" class="" style="text-align: center;">ì—°ì¤‘</td><td contenteditable="true" class="" style="text-align: center;">ì „ê¸°</td><td class="checkbox-cell"></td><td contenteditable="true" class="">25ë…„ ì‹¤ì  ê¸°ì¤€
ì´ 40ì„¸ëŒ€ì¤‘ 21ì„¸ëŒ€(í•˜ë°˜ê¸°) ì™„ë£Œ</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">18</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ê³„ì‹¤ ì•ˆì „ë³€ êµì²´ ë° ê¸‰íƒ• ì‹œìŠ¤í…œ í”ŒëŸ¬ì‹±</td><td contenteditable="true" class="currency-cell">5,000</td><td contenteditable="true" class="" style="text-align: center;">8ì›”</td><td contenteditable="true" class="" style="text-align: center;">ì¼ë°˜</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì•ˆì „ë°¸ë¸Œâ†’ ABë™: 5ê°œ / 3ë™: 4ê°œ / 102ë™: 1ê°œ
ê¸‰íƒ• ì‹œìŠ¤í…œ í”ŒëŸ¬ì‹±(ê¸°ê³„ì‹¤ì—ì„œ ê³µê¸‰)â†’ ABë™ ë° 3ë™</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">19</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ê³µìš© ì¶œì…êµ¬ í˜„ê´€ ê³„ë‹¨ ë³´ìˆ˜</td><td contenteditable="true" class="currency-cell">50,000</td><td contenteditable="true" class="" style="text-align: center;">9ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
2ë™(3ê°œ í˜„ê´€ì…êµ¬) / 5ë™(3ê°œ í˜„ê´€ì…êµ¬) / 8ë™(5ê°œ í˜„ê´€ì…êµ¬)</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">20</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ë™ í¡ì—°ë¶€ìŠ¤ì¸¡ ì£¼ë„ë¡œ ë§¤ë¦½ ì˜¤ìˆ˜ë°°ê´€ ë¶€ë¶„ êµì²´</td><td contenteditable="true" class="currency-cell">30,000</td><td contenteditable="true" class="" style="text-align: center;">8ì›”</td><td contenteditable="true" class="" style="text-align: center;">ê³µí†µ</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ì „ë…„ë„ ì´ì›”
ê¹Šì´ ì•½ 2m~3m í•˜ë¶€ ì˜¤ìˆ˜ë°°ê´€ ê¹¨ì§ êµì²´
ê±´ì¶• : ë„ë¡œ ì ˆê°œ ì² ê±° ë° ë°°ê´€ êµì²´í›„ ë„ë¡œ ë³µì›
ê¸°ê³„ : ë§¤ë¦½ ì´ì¤‘ ë³µí•©ê´€ ë¶€ë¶„ êµì²´ (ì„ì‹œ ê°€ì„¤  í›¼ì†  ì„¤ì¹˜)</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">21</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ë° ì‚¬íƒ ê¸´ê¸‰ë³´ìˆ˜ ì‘ì—…(ê¸°ê³„)</td><td contenteditable="true" class="currency-cell">10,000</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ê¸°ê³„</td><td class="checkbox-cell"></td><td contenteditable="true" class="">25ë…„ í•˜ë°˜ê¸° ì‹¤ì  ê¸°ì¤€
ë¹„í’ˆì„±/ì†Œì•¡ì„± ê¸´ê¸‰ ëŒ€ì‘</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">22</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ë° ì‚¬íƒ ê¸´ê¸‰ë³´ìˆ˜ ì‘ì—…(ê±´ì¶•)</td><td contenteditable="true" class="currency-cell">30,000</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">25ë…„ í•˜ë°˜ê¸° ì‹¤ì  ê¸°ì¤€
ë¹„í’ˆì„±/ì†Œì•¡ì„± ê¸´ê¸‰ ëŒ€ì‘</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">23</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ABë™ ë…¸í›„ ì‹œìŠ¤í…œ ì°½í˜¸ìš© ë°©ì¶©ë§ êµì²´ (ê³µìš©)</td><td contenteditable="true" class="currency-cell">18,000</td><td contenteditable="true" class="" style="text-align: center;">ìƒì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">ê³µìš©ì£¼ë°© 58ê°œì†Œ+ë³µë„ 64ê°œì†Œ=122ê°œì†Œ (í™”í•™ì œì™¸)
25ë…„ ê³µìš©ì£¼ë°© = 58ê°œì†Œ * 30ë§Œì› =17,400,000
ê³µìš©ë¶€ ì „ì²´ = 30ë§Œì›*122ê°œì†Œ = 36,600,000</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">24</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ê¸°ìˆ™ì‚¬ ABë™ ë…¸í›„ ì‹œìŠ¤í…œ ì°½í˜¸ìš© ë°©ì¶©ë§ êµì²´ (ì„¸ëŒ€ë‚´)</td><td contenteditable="true" class="currency-cell">8,000</td><td contenteditable="true" class="" style="text-align: center;">ìƒì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">304ì„¸ëŒ€(VIPì„¸ëŒ€ ë° í™”í•™ ì œì™¸)
25ë…„ í‡´ê±°ì˜ˆì • 25ì„¸ëŒ€ (ê³µê°€ì‹œ êµì²´)
30ë§Œì›*25ê°œì†Œ = 7,500,000</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">25</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ 102ë™ ì–´ë¦°ì´ì§‘ ë†€ì´í„° ì…êµ¬ ë³´ë„ë¸”ëŸ­ êµì²´</td><td contenteditable="true" class="currency-cell">20,000</td><td contenteditable="true" class="" style="text-align: center;">ìƒì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ê±´ì¶•</td><td class="checkbox-cell"></td><td contenteditable="true" class="">1-2 / 3-4 ë¼ì¸ : ë†€ì´í„° ì…êµ¬ ë° í˜„ê´€ ì• ì „ë©´ë¶€ ì¹¨í•˜ ë¶€ë¶„
5-6 ë¼ì¸ : ì„¸ëŒ€ ì…êµ¬ í˜„ê´€ íŠ¸ë Œì¹˜ ì• ì „ë©´ë¶€ ì¹¨í•˜ ë¶€ë¶„
ğŸ” ì² ê±°í›„ ë‚´ë¶€ ì ê²€ì‹œ ë³´ìˆ˜ í•„ìš” ë¶€ë¶„ì€ ë³„ë„ê²¬ì  í˜‘ì˜</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr><tr><td class="no-cell">26</td><td contenteditable="true" class="" style="text-align: center;">ìˆ˜ì„ </td><td contenteditable="true" class="">ì‚¬íƒ ì„¸ëŒ€ë‚´ ë…¸í›„ ì „ì› ì°¨ë‹¨ê¸° ë° ë¶„ì „ë°˜ êµì²´</td><td contenteditable="true" class="currency-cell">52,000</td><td contenteditable="true" class="" style="text-align: center;">ìƒì‹œ</td><td contenteditable="true" class="" style="text-align: center;">ì „ê¸°</td><td class="checkbox-cell"></td><td contenteditable="true" class="">26ë…„ 2ê°œë™ ì˜ˆìƒ(5ë™,9ë™)
1ë¼ì¸ë‹¹ : ì°¨ë‹¨ê¸°(í˜„ê´€/ì„¸ëŒ€)+íšŒë¡œë¶„ë¦¬=&gt;ì•½650ë§Œì›*4ê°œ ë¼ì¸(í‰ê· )
** 1ê°œë™ í‰ê· =&gt; 2,600ë§Œì› (2ë™,5ë™,8ë™,9ë™,7ë™)
** ëŒ€ìƒ ì „ì²´ë™ ì•½ 1.3ì–µ ì˜ˆìƒ</td><td contenteditable="true" class=""></td><div class="resizer-row"></div></tr></tbody>
    </table>
</div>

<div id="context-menu" style="display: none;">
    <ul>
        <li id="insert-row-above">ìœ„ì— í–‰ ì‚½ì…</li>
        <li id="insert-row-below">ì•„ë˜ì— í–‰ ì‚½ì…</li>
        <li id="delete-row">í–‰ ì‚­ì œ</li>
        <li class="separator"></li>
        <li id="insert-col-left">ì™¼ìª½ì— ì—´ ì‚½ì…</li>
        <li id="insert-col-right">ì˜¤ë¥¸ìª½ì— ì—´ ì‚½ì…</li>
        <li id="delete-col">ì—´ ì‚­ì œ</li>
    </ul>
</div>


<script src="https://cdn.sheetjs.com/xlsx-0.20.2/package/dist/xlsx.full.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // --- 1. ìš”ì†Œ ë° ë³€ìˆ˜ ì´ˆê¸°í™” ---
    const table = document.getElementById('main-table');
    const controlPanel = document.getElementById('control-panel');
    const contextMenu = document.getElementById('context-menu');
    const importExcelBtn = document.getElementById('importExcelBtn');
    const excelFileInput = document.getElementById('excel-file-input');
    let selectedCells = [];
    let contextTargetCell = null;
    let currencyColIndex = -1;
    let checkboxColIndex = -1;

    function findSpecialColumns() {
        const headers = Array.from(table.querySelectorAll('thead th'));
        currencyColIndex = headers.findIndex(th => th.innerText.includes('íˆ¬ìê¸ˆì•¡'));
        checkboxColIndex = headers.findIndex(th => th.innerText.includes('ì ìš©'));
    }

    // --- 2. ì…€ ì„ íƒ ë° UI ì—…ë°ì´íŠ¸ ---
    function clearSelection() {
        selectedCells.forEach(cell => cell.classList.remove('cell-selected'));
        selectedCells = [];
        updateEditorUI();
    }

    function addCellToSelection(cell) {
        if (!selectedCells.includes(cell) && !cell.classList.contains('no-cell') && cell.tagName === 'TD') {
            selectedCells.push(cell);
            cell.classList.add('cell-selected');
        }
    }

    function updateEditorUI() {
        document.querySelectorAll('#text-editor-menu button.active').forEach(b => b.classList.remove('active'));
        if (selectedCells.length === 0) return;
        const firstCell = selectedCells[0];
        const style = window.getComputedStyle(firstCell);
        
        document.querySelector(`#align-${style.textAlign}`)?.classList.add('active');
        document.querySelector(`#align-${style.verticalAlign}`)?.classList.add('active');
        
        if (style.fontWeight === '700' || style.fontWeight === 'bold') document.getElementById('editor-bold').classList.add('active');
        if (style.fontStyle === 'italic') document.getElementById('editor-italic').classList.add('active');
        if (style.textDecorationLine.includes('underline')) document.getElementById('editor-underline').classList.add('active');
        
        document.getElementById('editor-fontsize').value = style.fontSize;
        document.getElementById('editor-color').value = rgbToHex(style.color);
    }
    
    table.addEventListener('click', function(e) {
        const headerCell = e.target.closest('th');
        const targetCell = e.target.closest('td');

        if (targetCell && targetCell.classList.contains('checkbox-cell')) {
            e.preventDefault();
            targetCell.innerText = targetCell.innerText === 'âœ“' ? '' : 'âœ“';
            return;
        }

        if (headerCell) {
            e.preventDefault();
            clearSelection();
            const colIndex = headerCell.cellIndex;
            if (colIndex === 0) {
                 table.querySelectorAll('tbody td:not(.no-cell)').forEach(cell => addCellToSelection(cell));
            } else {
                table.querySelectorAll('tbody tr').forEach(row => {
                    if (row.cells[colIndex]) addCellToSelection(row.cells[colIndex]);
                });
            }
            updateEditorUI();
            return;
        }

        if (targetCell && targetCell.classList.contains('no-cell')) {
            e.preventDefault();
            clearSelection();
            const row = targetCell.closest('tr');
            Array.from(row.cells).forEach(cell => addCellToSelection(cell));
            updateEditorUI();
            return;
        }

        if (targetCell) {
             if (!e.ctrlKey && !e.metaKey && !e.shiftKey) {
                clearSelection();
                addCellToSelection(targetCell);
            } else if (e.ctrlKey || e.metaKey) {
                if (selectedCells.includes(targetCell)) {
                    targetCell.classList.remove('cell-selected');
                    selectedCells = selectedCells.filter(c => c !== targetCell);
                } else {
                    addCellToSelection(targetCell);
                }
            } else if (e.shiftKey && selectedCells.length > 0) {
                const allCells = Array.from(table.querySelectorAll('td:not(.no-cell)'));
                const firstIndex = allCells.indexOf(selectedCells[0]);
                const lastIndex = allCells.indexOf(targetCell);
                
                clearSelection();
                const start = Math.min(firstIndex, lastIndex);
                const end = Math.max(firstIndex, lastIndex);
                for (let i = start; i <= end; i++) {
                    addCellToSelection(allCells[i]);
                }
            }
            updateEditorUI();
        }
    });

    // --- 3. í…ìŠ¤íŠ¸ ì—ë””í„° ë° íŠ¹ìˆ˜ ê¸°ëŠ¥ ---
    function applyStyle(style, value, toggleValue = '') {
        if (selectedCells.length === 0) { alert("í¸ì§‘í•  ì…€ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
        selectedCells.forEach(cell => {
            if (!cell.classList.contains('checkbox-cell')) {
                 cell.style[style] = cell.style[style] === value ? toggleValue : value;
            }
        });
        updateEditorUI();
    }
    
    function applyAlignment(property, value) {
        if (selectedCells.length === 0) { alert("ì •ë ¬í•  ì…€ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
        selectedCells.forEach(cell => {
             if (!cell.classList.contains('checkbox-cell')) {
                cell.style[property] = value;
             }
        });
        updateEditorUI();
    }

    table.addEventListener('focusin', (e) => {
        if (e.target.matches('.currency-cell')) {
            e.target.innerText = e.target.innerText.replace(/,/g, '');
        }
    });

    table.addEventListener('focusout', (e) => {
        if (e.target.matches('.currency-cell')) {
            const value = parseFloat(e.target.innerText.replace(/,/g, ''));
            e.target.innerText = !isNaN(value) ? value.toLocaleString('en-US') : '';
        }
    });
    
    function formatAllCurrencyCells() {
        if (currencyColIndex === -1) return;
        table.querySelectorAll(`tbody td:nth-child(${currencyColIndex + 1})`).forEach(cell => {
            const value = parseFloat(cell.innerText.replace(/,/g, ''));
            cell.innerText = !isNaN(value) ? value.toLocaleString('en-US') : '';
        });
    }

    document.getElementById('editor-bold').addEventListener('click', () => applyStyle('fontWeight', 'bold', 'normal'));
    document.getElementById('editor-italic').addEventListener('click', () => applyStyle('fontStyle', 'italic', 'normal'));
    document.getElementById('editor-underline').addEventListener('click', () => applyStyle('textDecoration', 'underline', 'none'));
    document.getElementById('editor-fontsize').addEventListener('change', (e) => applyStyle('fontSize', e.target.value));
    document.getElementById('editor-color').addEventListener('input', (e) => applyStyle('color', e.target.value));
    document.getElementById('align-left').addEventListener('click', () => applyAlignment('textAlign', 'left'));
    document.getElementById('align-center').addEventListener('click', () => applyAlignment('textAlign', 'center'));
    document.getElementById('align-right').addEventListener('click', () => applyAlignment('textAlign', 'right'));
    document.getElementById('align-top').addEventListener('click', () => applyAlignment('verticalAlign', 'top'));
    document.getElementById('align-middle').addEventListener('click', () => applyAlignment('verticalAlign', 'middle'));
    document.getElementById('align-bottom').addEventListener('click', () => applyAlignment('verticalAlign', 'bottom'));
    
    document.getElementById('editor-link').addEventListener('click', () => {
        if (selectedCells.length === 0) { alert("ë§í¬ë¥¼ ì‚½ì…í•  ì…€ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
        const url = prompt("ë§í¬í•  URLì„ ì…ë ¥í•˜ì„¸ìš”:", "https://");
        if (url) {
            selectedCells[0].focus();
            document.execCommand('createLink', false, url);
        }
    });
    
    document.getElementById('editor-unlink').addEventListener('click', () => {
        if (selectedCells.length === 0) { alert("ë§í¬ë¥¼ ì œê±°í•  ì…€ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
        selectedCells[0].focus();
        document.execCommand('unlink', false, null);
    });

    function rgbToHex(rgb) {
        if (!rgb || !/^rgb/.test(rgb)) return '#000000';
        let parts = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
        if (!parts) return '#000000';
        delete(parts[0]);
        let hex = "#";
        for (let i = 1; i <= 3; ++i) {
            let part = parseInt(parts[i]).toString(16);
            hex += (part.length == 1) ? '0' + part : part;
        }
        return hex;
    }

    // --- 4. íŒŒì¼ I/O ---
    document.getElementById('saveHtmlBtn').addEventListener('click', () => {
        // â˜…â˜…â˜…â˜…â˜… í•˜ì´ë¼ì´íŠ¸ ë¬¸ì œ í•´ê²° ë¡œì§ â˜…â˜…â˜…â˜…â˜…
        // 1. í˜„ì¬ ë¬¸ì„œë¥¼ ë©”ëª¨ë¦¬ì— ë³µì œ
        const clonedDoc = document.documentElement.cloneNode(true);
        // 2. ë³µì œëœ ë¬¸ì„œì—ì„œë§Œ ì„ íƒ í´ë˜ìŠ¤ë¥¼ ì œê±°
        clonedDoc.querySelectorAll('.cell-selected').forEach(cell => {
            cell.classList.remove('cell-selected');
        });
        // 3. ê¹¨ë—í•´ì§„ ë³µì œë³¸ì˜ HTMLì„ ì €ì¥
        const pageHTML = '<!DOCTYPE html>\n' + clonedDoc.outerHTML;
        // â˜…â˜…â˜…â˜…â˜… ë¡œì§ ì¢…ë£Œ â˜…â˜…â˜…â˜…â˜…

        const blob = new Blob([pageHTML], { type: 'text/html;charset=utf-8' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = '26ë…„_ì—°ê°„ê³„íš_ì–‘ì‹.html';
        a.click();
        URL.revokeObjectURL(a.href);
    });

    document.getElementById('exportExcelBtn').addEventListener('click', () => {
        const wb = XLSX.utils.table_to_book(table, { sheet: "26ë…„ ì—°ê°„ ê³„íš" });
        XLSX.writeFile(wb, "26ë…„_ì—°ê°„ê³„íš_ëª©ë¡.xlsx");
    });

    importExcelBtn.addEventListener('click', () => excelFileInput.click());

    excelFileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (event) => {
            try {
                const data = new Uint8Array(event.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                populateTableWithData(jsonData);
                alert('ì—‘ì…€ ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë§¤í•‘í–ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error("ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:", error);
                alert('ì—‘ì…€ íŒŒì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                e.target.value = '';
            }
        };
        reader.readAsArrayBuffer(file);
    });
    
    function populateTableWithData(data) {
        if (!data || data.length < 1) { alert('ë§¤í•‘í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }
        
        const thead = table.tHead;
        const tbody = table.tBodies[0];
        const excelHeaders = data[0].map(h => String(h).replace(/\n/g, ' '));
        const currentHeaders = Array.from(thead.rows[0].cells).map(th => th.innerText.replace(/\n/g, ' '));
        
        if (JSON.stringify(excelHeaders) !== JSON.stringify(currentHeaders)) {
            alert('ì—‘ì…€ íŒŒì¼ì˜ í—¤ë”ê°€ í˜„ì¬ í…Œì´ë¸” ì–‘ì‹ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            return;
        }
        
        tbody.innerHTML = '';
        const dataRows = data.slice(1);
        dataRows.forEach(rowData => {
            const newRow = tbody.insertRow();
            newRow.insertCell(0).classList.add('no-cell');
            for (let i = 1; i < currentHeaders.length; i++) {
                const cell = newRow.insertCell(i);
                const cellValue = rowData[i] || '';
                if (i === checkboxColIndex) {
                    cell.classList.add('checkbox-cell');
                    cell.innerText = cellValue === 'âœ“' ? 'âœ“' : '';
                } else {
                    cell.contentEditable = 'true';
                    cell.innerHTML = cellValue;
                    if (i === currencyColIndex) {
                        cell.classList.add('currency-cell');
                    }
                }
            }
        });

        updateRowNumbers();
        initializeResizableTable();
        formatAllCurrencyCells();
        clearSelection();
    }

    // --- 5. í…Œì´ë¸” í¬ê¸° ì¡°ì ˆ ---
    function attachColResizer(th, colIndex) {
        if (th.querySelector('.resizer-col')) th.querySelector('.resizer-col').remove();
        const resizer = document.createElement('div');
        resizer.className = 'resizer-col';
        th.appendChild(resizer);
        
        resizer.addEventListener('mousedown', (e) => {
            e.preventDefault(); e.stopPropagation();
            let startX = e.pageX;
            const colElement = table.querySelector('colgroup').children[colIndex];
            let startWidth = colElement.offsetWidth;
            
            const onMouseMove = (moveEvent) => {
                const newWidth = startWidth + (moveEvent.pageX - startX);
                if (newWidth > 30) colElement.style.width = newWidth + 'px';
            };
            const onMouseUp = () => document.removeEventListener('mousemove', onMouseMove);
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp, { once: true });
        });
    }

    function attachRowResizer(row) {
        if (row.querySelector('.resizer-row')) row.querySelector('.resizer-row').remove();
        const resizer = document.createElement('div');
        resizer.className = 'resizer-row';
        row.appendChild(resizer);
        
        resizer.addEventListener('mousedown', (e) => {
             e.preventDefault(); e.stopPropagation();
             let startY = e.pageY;
             let startHeight = row.offsetHeight;
             
             const onMouseMove = (moveEvent) => {
                const newHeight = startHeight + (moveEvent.pageY - startY);
                if (newHeight > 30) row.style.height = newHeight + 'px';
             };
             const onMouseUp = () => document.removeEventListener('mousemove', onMouseMove);
             document.addEventListener('mousemove', onMouseMove);
             document.addEventListener('mouseup', onMouseUp, { once: true });
        });
    }

    function initializeResizableTable() {
        table.querySelectorAll('thead th').forEach((th, i) => attachColResizer(th, i));
        table.querySelectorAll('tbody tr').forEach(row => attachRowResizer(row));
    }

    // --- 6. ìë™ ë²ˆí˜¸ ë° í–‰/ì—´ ê´€ë¦¬ ---
    function updateRowNumbers() {
        table.querySelectorAll('tbody tr').forEach((row, index) => {
            const noCell = row.cells[0];
            if (noCell) { noCell.innerText = index + 1; }
        });
    }

    function insertRow(index, above = true) {
        const tbody = table.tBodies[0];
        const colCount = table.rows[0].cells.length;
        const targetIndex = above ? index : index + 1;
        const newRow = tbody.insertRow(targetIndex);

        newRow.insertCell(0).classList.add('no-cell');
        for (let i = 1; i < colCount; i++) {
            const newCell = newRow.insertCell(i);
            if (i === checkboxColIndex) {
                 newCell.classList.add('checkbox-cell');
            } else {
                 newCell.contentEditable = 'true';
                 if (i === currencyColIndex) {
                    newCell.classList.add('currency-cell');
                }
            }
        }
        attachRowResizer(newRow);
        updateRowNumbers();
    }

    function deleteRow(index) {
        if (table.tBodies[0].rows.length > 1) {
            table.tBodies[0].deleteRow(index);
            updateRowNumbers();
        } else {
            alert("ë§ˆì§€ë§‰ í–‰ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }
    }

    function insertColumn(index, before = true) {
        if (index === 0 && before) { alert("'NO.' ì—´ì˜ ì™¼ìª½ì— ì—´ì„ ì¶”ê°€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); return; }
        const targetIndex = before ? index : index + 1;
        
        table.querySelector('colgroup').children[targetIndex-1].insertAdjacentHTML('afterend', '<col style="width: 10%;">');
        table.tHead.rows[0].cells[targetIndex-1].insertAdjacentHTML('afterend', '<th contenteditable="true">ìƒˆ í•­ëª©</th>');
        Array.from(table.tBodies[0].rows).forEach(row => {
            row.cells[targetIndex-1].insertAdjacentHTML('afterend', '<td contenteditable="true"></td>');
        });
        
        findSpecialColumns();
        initializeResizableTable();
    }

    function deleteColumn(index) {
        if (index === 0) { alert("'NO.' ì—´ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); return; }
        if (table.rows[0].cells.length > 2) {
            table.querySelector('colgroup').children[index].remove();
            Array.from(table.rows).forEach(row => row.deleteCell(index));
            findSpecialColumns();
            initializeResizableTable();
        } else {
            alert("ë§ˆì§€ë§‰ í•­ëª© ì—´ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }
    }

    // --- 7. ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ê´€ë¦¬ ---
    table.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        const target = e.target.closest('td, th');
        if (!target) return;
        
        contextTargetCell = target;
        const isNoColumn = contextTargetCell.cellIndex === 0;
        document.getElementById('delete-col').style.display = isNoColumn ? 'none' : 'block';
        document.getElementById('insert-col-left').style.display = isNoColumn ? 'none' : 'block';

        contextMenu.style.display = 'block';
        contextMenu.style.left = `${e.pageX}px`;
        contextMenu.style.top = `${e.pageY}px`;
    });

    document.addEventListener('click', (e) => {
        if (!contextMenu.contains(e.target) && !e.target.closest('#control-panel')) {
             contextMenu.style.display = 'none';
        }
        if (!table.contains(e.target) && !controlPanel.contains(e.target) && !contextMenu.contains(e.target)) {
            clearSelection();
        }
    });

    contextMenu.addEventListener('click', (e) => {
        if (!contextTargetCell) return;
        
        const cellIndex = contextTargetCell.cellIndex;
        const tr = contextTargetCell.closest('tr');
        const rowIndex = Array.from(tr.parentNode.children).indexOf(tr);

        switch (e.target.id) {
            case 'insert-row-above': if (tr.parentNode.tagName === 'TBODY') insertRow(rowIndex, true); break;
            case 'insert-row-below': if (tr.parentNode.tagName === 'TBODY') insertRow(rowIndex, false); break;
            case 'delete-row': if (contextTargetCell.tagName === 'TD') deleteRow(rowIndex); break;
            case 'insert-col-left': insertColumn(cellIndex, true); break;
            case 'insert-col-right': insertColumn(cellIndex, false); break;
            case 'delete-col': deleteColumn(cellIndex); break;
        }
        contextMenu.style.display = 'none';
    });

    // --- 8. ìµœì¢… ì´ˆê¸°í™” ì‹¤í–‰ ---
    findSpecialColumns();
    initializeResizableTable();
    updateRowNumbers();
    formatAllCurrencyCells();
    clearSelection();
});
</script>


</body></html>